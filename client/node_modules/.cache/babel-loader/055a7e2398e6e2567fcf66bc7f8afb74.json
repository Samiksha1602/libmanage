{"ast":null,"code":"import*as ActionTypes from'./ActionTypes';import{baseUrl}from'../baseUrl';export var addBook=function addBook(book){return{type:ActionTypes.ADD_BOOK,payload:book};};export var postBook=function postBook(name,author,description,isbn,cat,floor,shelf,copies){return function(dispatch){var newBook={name:name,author:author,description:description,isbn:isbn,cat:cat,floor:floor,shelf:shelf,copies:copies};var bearer='Bearer '+localStorage.getItem('token');return fetch(baseUrl+'books',{method:\"POST\",body:JSON.stringify(newBook),headers:{\"Content-Type\":\"application/json\",'Authorization':bearer}//   ,        credentials: \"same-origin\"\n}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){alert('Book added successfully');return dispatch(addBook(response));}).catch(function(error){alert('Your book could not be added\\nError: '+error.message);});};};export var editBook=function editBook(_id,name,author,description,isbn,cat,floor,shelf,copies){return function(dispatch){var newBook={name:name,author:author,description:description,isbn:isbn,cat:cat,floor:floor,shelf:shelf,copies:copies};var bearer='Bearer '+localStorage.getItem('token');return fetch(baseUrl+'books/'+_id,{method:\"PUT\"//  ,     credentials: 'same-origin'\n,body:JSON.stringify(newBook),headers:{\"Content-Type\":\"application/json\",'Authorization':bearer}}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){return dispatch(editBookdispatch(response));}).catch(function(error){alert('Your book could not be edited\\nError: '+error.message);});};};export var editPassword=function editPassword(_id,username,password){return function(dispatch){var bearer='Bearer '+localStorage.getItem('token');return fetch(baseUrl+'users/password/'+_id,{method:\"PUT\"//  ,     credentials: 'same-origin'\n,body:JSON.stringify({password:password}),headers:{\"Content-Type\":\"application/json\",'Authorization':bearer}}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText+'\\n ');error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){var newCreds={username:username,password:password};localStorage.removeItem('creds');localStorage.setItem('creds',JSON.stringify(newCreds));alert('Password changed successfully');return dispatch(editPasswordDispatch(newCreds));}).catch(function(error){alert('Your password could not be changed\\nError: '+error.message);});};};export var editUser=function editUser(_id,firstname,lastname,roll,email){return function(dispatch){var newUser={firstname:firstname,lastname:lastname,roll:roll,email:email};var bearer='Bearer '+localStorage.getItem('token');return fetch(baseUrl+'users/'+_id,{method:\"PUT\"//  ,     credentials: 'same-origin'\n,body:JSON.stringify(newUser),headers:{\"Content-Type\":\"application/json\",'Authorization':bearer}}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){localStorage.removeItem('userinfo');localStorage.setItem('userinfo',JSON.stringify(response));return dispatch(editUserdispatch(response));}).catch(function(error){alert('Your profile could not be edited\\nError: '+error.message+'\\n May be someone has already registered with that Roll No. or Email');});};};export var deleteBook=function deleteBook(_id){return function(dispatch){var bearer='Bearer '+localStorage.getItem('token');return fetch(baseUrl+'books/'+_id,{method:\"DELETE\"//  ,       credentials: \"same-origin\"\n,headers:{'Authorization':bearer}}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){return dispatch(deleteBookdispatch(response));}).catch(function(error){alert('Your book could not be deleted\\nError: '+error.message);});};};export var fetchBooks=function fetchBooks(){return function(dispatch){dispatch(booksLoading(true));return fetch(baseUrl+'books').then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){var errmess=new Error(error.message);throw errmess;}).then(function(response){return response.json();}).then(function(books){return dispatch(addBooks(books));}).catch(function(error){return dispatch(booksFailed(error.message));});};};export var fetchUsers=function fetchUsers(){return function(dispatch){var bearer='Bearer '+localStorage.getItem('token');dispatch(usersLoading(true));return fetch(baseUrl+'users',{headers:{'Authorization':bearer}}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){var errmess=new Error(error.message);throw errmess;}).then(function(response){return response.json();}).then(function(users){return dispatch(addUsers(users));}).catch(function(error){return dispatch(usersFailed(error.message));});};};export var booksLoading=function booksLoading(){return{type:ActionTypes.BOOKS_LOADING};};export var booksFailed=function booksFailed(errmess){return{type:ActionTypes.BOOKS_FAILED,payload:errmess};};export var addBooks=function addBooks(books){return{type:ActionTypes.ADD_BOOKS,payload:books};};export var addUsers=function addUsers(users){return{type:ActionTypes.ADD_USERS,payload:users};};export var usersLoading=function usersLoading(){return{type:ActionTypes.USERS_LOADING};};export var editBookdispatch=function editBookdispatch(books){return{type:ActionTypes.EDIT_BOOK,payload:books};};export var returnBookdispatch=function returnBookdispatch(issue){return{type:ActionTypes.RETURN_ISSUE,payload:issue};};export var editUserdispatch=function editUserdispatch(USER){return{type:ActionTypes.EDIT_USER,payload:USER};};export var editPasswordDispatch=function editPasswordDispatch(CREDS){return{type:ActionTypes.EDIT_PASSWORD,payload:CREDS};};export var deleteBookdispatch=function deleteBookdispatch(resp){return{type:ActionTypes.DELETE_BOOK,payload:resp};};export var requestLogin=function requestLogin(creds){return{type:ActionTypes.LOGIN_REQUEST,creds:creds};};export var receiveLogin=function receiveLogin(response){return{type:ActionTypes.LOGIN_SUCCESS,token:response.token,userinfo:response.userinfo};};export var loginError=function loginError(message){return{type:ActionTypes.LOGIN_FAILURE,message:message};};export var loginUser=function loginUser(creds){return function(dispatch){dispatch(requestLogin(creds));return fetch(baseUrl+'users/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(creds)}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){if(response.success){// If login was successful, set the token in local storage\nlocalStorage.setItem('token',response.token);localStorage.setItem('creds',JSON.stringify(creds));localStorage.setItem('userinfo',JSON.stringify(response.userinfo));dispatch(fetchIssues(!response.userinfo.admin));if(response.userinfo.admin){dispatch(fetchUsers());}setTimeout(function(){logoutUser();alert('Your JWT token has expired. \\nPlease log in again to continue.');},3600*1000);// Dispatch the success action\ndispatch(receiveLogin(response));}else{var error=new Error('Error '+response.status);error.response=response;throw error;}}).catch(function(error){alert(error.message+'\\n'+\"Username and password didn't match\");return dispatch(loginError(error.message));});};};export var registerUser=function registerUser(creds){return function(dispatch){return fetch(baseUrl+'users/signup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(creds)}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){if(response.success){// If Registration was successful, alert the user\nalert('Registration Successful');}else{var error=new Error('Error '+response.status);error.response=response;throw error;}}).catch(function(error){return alert(error.message+'\\n'+'May be someone has already registered with that username, email or Roll No.\\nTry Entering a new username,email or Roll No. ');});};};export var addIssue=function addIssue(issue){return{type:ActionTypes.ADD_ISSUE,payload:issue};};export var postIssue=function postIssue(bookId,studentId){return function(dispatch){var newIssue={book:bookId,student:studentId};var bearer='Bearer '+localStorage.getItem('token');return fetch(baseUrl+'issues',{method:\"POST\",body:JSON.stringify(newIssue),headers:{\"Content-Type\":\"application/json\",'Authorization':bearer}//   ,        credentials: \"same-origin\"\n}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){alert('Book issued successfully');return dispatch(addIssue(response));}).catch(function(error){alert('Book could not be issued\\nError: '+error.message+'\\n'+'May be the student has already issued 3 books and not returned. Please return them first. \\n'+'or the book may not available. You can wait for some days, until the book is returned to library.');});};};export var returnIssue=function returnIssue(issueId){return function(dispatch){var bearer='Bearer '+localStorage.getItem('token');return fetch(baseUrl+'issues/'+issueId,{method:\"PUT\"//  ,     credentials: 'same-origin'\n,headers:{\"Content-Type\":\"application/json\",'Authorization':bearer}}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){throw error;}).then(function(response){return response.json();}).then(function(response){alert('Book returned successfully');return dispatch(returnBookdispatch(response));}).catch(function(error){alert('The book could not be returned\\nError: '+error.message);});};};export var fetchIssues=function fetchIssues(student){return function(dispatch){var issueUrl;var bearer='Bearer '+localStorage.getItem('token');if(student){issueUrl='issues/student';}else{issueUrl='issues';}dispatch(issuesLoading(true));return fetch(baseUrl+issueUrl,{headers:{'Authorization':bearer}}).then(function(response){if(response.ok){return response;}else{var error=new Error('Error '+response.status+': '+response.statusText);error.response=response;throw error;}},function(error){var errmess=new Error(error.message);throw errmess;}).then(function(response){return response.json();}).then(function(issues){return dispatch(addIssues(issues));}).catch(function(error){return dispatch(issuesFailed(error.message));});};};export var issuesLoading=function issuesLoading(){return{type:ActionTypes.ISSUES_LOADING};};export var issuesFailed=function issuesFailed(errmess){return{type:ActionTypes.ISSUES_FAILED,payload:errmess};};export var addIssues=function addIssues(issues){return{type:ActionTypes.ADD_ISSUES,payload:issues};};export var usersFailed=function usersFailed(errmess){return{type:ActionTypes.USERS_FAILED,payload:errmess};};export var requestLogout=function requestLogout(){return{type:ActionTypes.LOGOUT_REQUEST};};export var receiveLogout=function receiveLogout(){return{type:ActionTypes.LOGOUT_SUCCESS};};export var logoutUser=function logoutUser(){return function(dispatch){dispatch(requestLogout());localStorage.removeItem('token');localStorage.removeItem('creds');localStorage.removeItem('userinfo');dispatch(receiveLogout());};};","map":{"version":3,"sources":["D:/sakshi college/cc miniproject/lib_management/client/src/redux/ActionCreators.js"],"names":["ActionTypes","baseUrl","addBook","book","type","ADD_BOOK","payload","postBook","name","author","description","isbn","cat","floor","shelf","copies","dispatch","newBook","bearer","localStorage","getItem","fetch","method","body","JSON","stringify","headers","then","response","ok","error","Error","status","statusText","json","alert","catch","message","editBook","_id","editBookdispatch","editPassword","username","password","newCreds","removeItem","setItem","editPasswordDispatch","editUser","firstname","lastname","roll","email","newUser","editUserdispatch","deleteBook","deleteBookdispatch","fetchBooks","booksLoading","errmess","books","addBooks","booksFailed","fetchUsers","usersLoading","users","addUsers","usersFailed","BOOKS_LOADING","BOOKS_FAILED","ADD_BOOKS","ADD_USERS","USERS_LOADING","EDIT_BOOK","returnBookdispatch","issue","RETURN_ISSUE","USER","EDIT_USER","CREDS","EDIT_PASSWORD","resp","DELETE_BOOK","requestLogin","creds","LOGIN_REQUEST","receiveLogin","LOGIN_SUCCESS","token","userinfo","loginError","LOGIN_FAILURE","loginUser","success","fetchIssues","admin","setTimeout","logoutUser","registerUser","addIssue","ADD_ISSUE","postIssue","bookId","studentId","newIssue","student","returnIssue","issueId","issueUrl","issuesLoading","issues","addIssues","issuesFailed","ISSUES_LOADING","ISSUES_FAILED","ADD_ISSUES","USERS_FAILED","requestLogout","LOGOUT_REQUEST","receiveLogout","LOGOUT_SUCCESS"],"mappings":"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","sourcesContent":["import * as ActionTypes from './ActionTypes';\r\nimport {baseUrl} from '../baseUrl'\r\n\r\nexport const addBook = (book) => ({\r\n  type: ActionTypes.ADD_BOOK,\r\n  payload: book\r\n});\r\n\r\nexport const postBook = (name, author, description, isbn, cat, floor, shelf, copies) => (dispatch) => {\r\n    const newBook = {\r\n      name: name, author: author,\r\n       description: description, isbn: isbn,\r\n        cat: cat, floor: floor, \r\n        shelf: shelf, copies: copies\r\n    };\r\n    const bearer = 'Bearer ' + localStorage.getItem('token');\r\n    return fetch(baseUrl + 'books', {\r\n        method: \"POST\",\r\n        body: JSON.stringify(newBook),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          'Authorization': bearer\r\n        }\r\n     //   ,        credentials: \"same-origin\"\r\n    })\r\n    .then(response => {\r\n        if (response.ok) {\r\n          return response;\r\n        } else {\r\n          var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n          error.response = response;\r\n          throw error;\r\n        }\r\n      },\r\n      error => {\r\n            throw error;\r\n      })\r\n    .then(response => response.json())\r\n    .then(response => { alert('Book added successfully');\r\n      return  dispatch(addBook(response));})\r\n    .catch(error =>  { alert('Your book could not be added\\nError: '+error.message); });\r\n};\r\n\r\nexport const editBook = (_id, name, author, description, isbn, cat, floor, shelf, copies) => (dispatch) => {\r\n\r\n  const newBook = {\r\n    name: name, author: author,\r\n     description: description, isbn: isbn,\r\n      cat: cat, floor: floor, \r\n      shelf: shelf, copies: copies\r\n  };\r\n  const bearer = 'Bearer ' + localStorage.getItem('token');\r\n  return fetch(baseUrl + 'books/' + _id, {\r\n      method: \"PUT\"\r\n    //  ,     credentials: 'same-origin'\r\n      ,      body: JSON.stringify(newBook),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        'Authorization': bearer\r\n      } })\r\n  .then(response => {\r\n      if (response.ok) {\r\n        return response;\r\n      } else {\r\n        var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n        error.response = response;\r\n        throw error;\r\n      }\r\n    },\r\n    error => {\r\n          throw error;\r\n    })\r\n  .then(response => response.json())\r\n  .then(response => (dispatch(editBookdispatch(response))))\r\n  .catch(error =>  {  \r\n  alert('Your book could not be edited\\nError: '+error.message); });\r\n};\r\n\r\nexport const editPassword = (_id,username,password) => (dispatch) => {\r\n  const bearer = 'Bearer ' + localStorage.getItem('token');\r\n  return fetch(baseUrl + 'users/password/' + _id, {\r\n    method: \"PUT\"\r\n  //  ,     credentials: 'same-origin'\r\n    ,      body: JSON.stringify({password: password}),\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      'Authorization': bearer\r\n    } })\r\n.then(response => {\r\n    if (response.ok) {\r\n      return response;\r\n    } else {\r\n      var error = new Error('Error ' + response.status + ': ' + response.statusText+'\\n ');\r\n      error.response = response;\r\n      throw error;\r\n    }\r\n  },\r\n  error => {\r\n        throw error;\r\n  })\r\n.then(response => response.json())\r\n.then(response => { \r\n  let newCreds={username: username, password: password};\r\n  localStorage.removeItem('creds');\r\n  localStorage.setItem('creds', JSON.stringify(newCreds));\r\n  alert('Password changed successfully');\r\n  return dispatch(editPasswordDispatch(newCreds));})\r\n.catch(error =>  {  \r\nalert('Your password could not be changed\\nError: '+error.message); });\r\n}\r\n\r\nexport const editUser = (_id, firstname, lastname, roll, email) => (dispatch) => {\r\n\r\n  const newUser = {\r\nfirstname: firstname,\r\nlastname: lastname,\r\nroll: roll,\r\nemail: email  };\r\n  const bearer = 'Bearer ' + localStorage.getItem('token');\r\n  return fetch(baseUrl + 'users/' + _id, {\r\n      method: \"PUT\"\r\n    //  ,     credentials: 'same-origin'\r\n      ,      body: JSON.stringify(newUser),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        'Authorization': bearer\r\n      } })\r\n  .then(response => {\r\n      if (response.ok) {\r\n        return response;\r\n      } else {\r\n        var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n        error.response = response;\r\n        throw error;\r\n      }\r\n    },\r\n    error => {\r\n          throw error;\r\n    })\r\n  .then(response => response.json())\r\n  .then(response => { \r\n    localStorage.removeItem('userinfo');\r\n    localStorage.setItem('userinfo', JSON.stringify(response));\r\n    return dispatch(editUserdispatch(response));})\r\n  .catch(error =>  {  \r\n  alert('Your profile could not be edited\\nError: '+error.message+'\\n May be someone has already registered with that Roll No. or Email'); });\r\n};\r\n\r\nexport const deleteBook = (_id) => (dispatch) => {\r\n  \r\n  const bearer = 'Bearer ' + localStorage.getItem('token');    \r\n  return fetch(baseUrl + 'books/' + _id, {\r\n      method: \"DELETE\"\r\n    //  ,       credentials: \"same-origin\"\r\n      ,       headers: {\r\n        'Authorization': bearer\r\n      }\r\n  })\r\n  .then(response => {\r\n      if (response.ok) {\r\n        return response;\r\n      } else {\r\n        var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n        error.response = response;\r\n        throw error;\r\n      }\r\n    },\r\n    error => {\r\n          throw error;\r\n    })\r\n  .then(response => response.json())\r\n  .then(response => dispatch(deleteBookdispatch(response)))\r\n  .catch(error =>  {alert('Your book could not be deleted\\nError: '+error.message); });\r\n};\r\n\r\nexport const fetchBooks = () => (dispatch) => {\r\n    dispatch(booksLoading(true));\r\n    return fetch(baseUrl+'books')\r\n        .then(response => {\r\n        if (response.ok) {\r\n          return response;\r\n        } else {\r\n          var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n          error.response = response;\r\n          throw error;\r\n        }\r\n      },\r\n      error => {\r\n            var errmess = new Error(error.message);\r\n            throw errmess;\r\n      })\r\n    .then(response => response.json())\r\n    .then(books => dispatch(addBooks(books)))\r\n    .catch(error => dispatch(booksFailed(error.message)));\r\n}\r\n\r\n\r\nexport const fetchUsers = () => (dispatch) => {\r\n  const bearer = 'Bearer ' + localStorage.getItem('token');\r\n  dispatch(usersLoading(true));\r\n  return fetch(baseUrl+'users',{\r\n    headers: {\r\n      'Authorization': bearer\r\n    }\r\n  })\r\n      .then(response => {\r\n      if (response.ok) {\r\n        return response;\r\n      } else {\r\n        var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n        error.response = response;\r\n        throw error;\r\n      }\r\n    },\r\n    error => {\r\n          var errmess = new Error(error.message);\r\n          throw errmess;\r\n    })\r\n  .then(response => response.json())\r\n  .then(users => dispatch(addUsers(users)))\r\n  .catch(error => dispatch(usersFailed(error.message)));\r\n}\r\n\r\n\r\nexport const booksLoading = () => ({\r\n    type: ActionTypes.BOOKS_LOADING\r\n});\r\n\r\nexport const booksFailed = (errmess) => ({\r\n    type: ActionTypes.BOOKS_FAILED,\r\n    payload: errmess\r\n});\r\n\r\nexport const addBooks = (books) => ({\r\n    type: ActionTypes.ADD_BOOKS,\r\n    payload: books\r\n});\r\n\r\nexport const addUsers = (users) => ({\r\n  type: ActionTypes.ADD_USERS,\r\n  payload: users\r\n});\r\n\r\nexport const usersLoading = () => ({\r\n  type: ActionTypes.USERS_LOADING\r\n});\r\n\r\nexport const editBookdispatch = (books) => ({\r\n  type: ActionTypes.EDIT_BOOK,\r\n  payload: books\r\n});\r\n\r\nexport const returnBookdispatch = (issue) => ({\r\n  type: ActionTypes.RETURN_ISSUE,\r\n  payload: issue\r\n});\r\n\r\nexport const editUserdispatch = (USER) => ({\r\n  type: ActionTypes.EDIT_USER,\r\n  payload: USER\r\n});\r\n\r\nexport const editPasswordDispatch = (CREDS) => ({\r\n  type: ActionTypes.EDIT_PASSWORD,\r\n  payload: CREDS\r\n})\r\n\r\nexport const deleteBookdispatch = (resp) => ({\r\n  type: ActionTypes.DELETE_BOOK,\r\n  payload: resp\r\n});\r\n\r\nexport const requestLogin = (creds) => {\r\n  return {\r\n      type: ActionTypes.LOGIN_REQUEST,\r\n      creds\r\n  }\r\n}\r\n\r\nexport const receiveLogin = (response) => {\r\n  return {\r\n      type: ActionTypes.LOGIN_SUCCESS,\r\n      token: response.token,\r\n      userinfo: response.userinfo\r\n  }\r\n}\r\n\r\nexport const loginError = (message) => {\r\n  return {\r\n      type: ActionTypes.LOGIN_FAILURE,\r\n      message\r\n  }\r\n}\r\n\r\nexport const loginUser = (creds) => (dispatch) => {\r\n\r\n  dispatch(requestLogin(creds));\r\n  return fetch(baseUrl + 'users/login', {\r\n      method: 'POST',\r\n      headers: { \r\n          'Content-Type':'application/json' \r\n      },\r\n      body: JSON.stringify(creds)\r\n  })\r\n  .then(response => {\r\n      if (response.ok) {\r\n          return response;\r\n      } else {\r\n          var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n          error.response = response;\r\n          throw error;\r\n      }\r\n      },\r\n      error => {\r\n          throw error;\r\n      })\r\n  .then(response => response.json())\r\n  .then(response => {\r\n      if (response.success) {\r\n          // If login was successful, set the token in local storage\r\n          localStorage.setItem('token', response.token);\r\n          localStorage.setItem('creds', JSON.stringify(creds));\r\n          localStorage.setItem('userinfo', JSON.stringify(response.userinfo));    \r\n          dispatch(fetchIssues(!response.userinfo.admin));      \r\n          if(response.userinfo.admin) {\r\n            dispatch(fetchUsers())\r\n          }\r\n          setTimeout(()=>{\r\n            logoutUser();\r\n            alert('Your JWT token has expired. \\nPlease log in again to continue.');\r\n           },3600*1000);\r\n          // Dispatch the success action\r\n          dispatch(receiveLogin(response));\r\n      \r\n      }\r\n      else {\r\n          var error = new Error('Error ' + response.status);\r\n          error.response = response;\r\n          throw error;\r\n      }\r\n  })\r\n  .catch(error => {\r\n    alert(error.message+'\\n'+\"Username and password didn't match\");\r\n     return dispatch(loginError(error.message));})\r\n};\r\n\r\nexport const registerUser = (creds) => (dispatch) => {\r\n\r\n\r\n  return fetch(baseUrl + 'users/signup', {\r\n      method: 'POST',\r\n      headers: { \r\n          'Content-Type':'application/json' \r\n      },\r\n      body: JSON.stringify(creds)\r\n  })\r\n  .then(response => {\r\n      if (response.ok) {\r\n          return response;\r\n      } else {\r\n          var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n          error.response = response;\r\n          throw error;\r\n      }\r\n      },\r\n      error => {\r\n          throw error;\r\n      })\r\n  .then(response => response.json())\r\n  .then(response => {\r\n      if (response.success) {\r\n          // If Registration was successful, alert the user\r\n          alert('Registration Successful');\r\n        }\r\n      else {\r\n          var error = new Error('Error ' + response.status);\r\n          error.response = response;\r\n          throw error;\r\n      }\r\n  })\r\n  .catch(error => alert(error.message+'\\n'+\r\n      'May be someone has already registered with that username, email or Roll No.\\nTry Entering a new username,email or Roll No. '))\r\n};\r\n\r\nexport const addIssue = (issue) => ({\r\n  type: ActionTypes.ADD_ISSUE,\r\n  payload: issue\r\n});\r\n\r\nexport const postIssue = (bookId,studentId) => (dispatch) => {\r\n    const newIssue = {\r\n    book: bookId,\r\n    student: studentId \r\n    };\r\n    const bearer = 'Bearer ' + localStorage.getItem('token');\r\n    return fetch(baseUrl + 'issues', {\r\n        method: \"POST\",\r\n        body: JSON.stringify(newIssue),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          'Authorization': bearer\r\n        }\r\n     //   ,        credentials: \"same-origin\"\r\n    })\r\n    .then(response => {\r\n        if (response.ok) {\r\n          return response;\r\n        } else {\r\n          var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n          error.response = response;\r\n          throw error;\r\n        }\r\n      },\r\n      error => {\r\n            throw error;\r\n      })\r\n    .then(response => response.json())\r\n    .then(response => { alert('Book issued successfully');\r\n      return  dispatch(addIssue(response));})\r\n    .catch(error =>  {\r\n      alert('Book could not be issued\\nError: '+error.message+'\\n'+\r\n      'May be the student has already issued 3 books and not returned. Please return them first. \\n'+\r\n      'or the book may not available. You can wait for some days, until the book is returned to library.'); });\r\n};\r\n\r\nexport const returnIssue = (issueId) => (dispatch) => {\r\n  const bearer = 'Bearer ' + localStorage.getItem('token');\r\n  return fetch(baseUrl + 'issues/' + issueId, {\r\n      method: \"PUT\"\r\n    //  ,     credentials: 'same-origin'\r\n    , headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        'Authorization': bearer\r\n      } })\r\n  .then(response => {\r\n      if (response.ok) {\r\n        return response;\r\n      } else {\r\n        var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n        error.response = response;\r\n        throw error;\r\n      }\r\n    },\r\n    error => {\r\n          throw error;\r\n    })\r\n  .then(response => response.json())\r\n  .then(response => { \r\n    alert('Book returned successfully');\r\n    return dispatch(returnBookdispatch(response));})\r\n  .catch(error =>  {  \r\n  alert('The book could not be returned\\nError: '+error.message); });\r\n};\r\n\r\nexport const fetchIssues = (student) => (dispatch) => {\r\n  let issueUrl;\r\n  const bearer = 'Bearer ' + localStorage.getItem('token');\r\n  if(student) {\r\n    issueUrl='issues/student';\r\n  }\r\n  else {\r\n    issueUrl='issues';\r\n  }\r\n  dispatch(issuesLoading(true));\r\n  return fetch(baseUrl+issueUrl,{\r\n     headers: {\r\n        'Authorization': bearer\r\n       }\r\n  })\r\n      .then(response => {\r\n      if (response.ok) {\r\n        return response;\r\n      } else {\r\n        var error = new Error('Error ' + response.status + ': ' + response.statusText);\r\n        error.response = response;\r\n        throw error;\r\n      }\r\n    },\r\n    error => {\r\n          var errmess = new Error(error.message);\r\n          throw errmess;\r\n    })\r\n  .then(response => response.json())\r\n  .then(issues => dispatch(addIssues(issues)))\r\n  .catch(error => dispatch(issuesFailed(error.message)));\r\n}\r\n\r\n\r\n\r\nexport const issuesLoading = () => ({\r\n  type: ActionTypes.ISSUES_LOADING\r\n});\r\n\r\nexport const issuesFailed = (errmess) => ({\r\n  type: ActionTypes.ISSUES_FAILED,\r\n  payload: errmess\r\n});\r\n\r\nexport const addIssues = (issues) => ({\r\n  type: ActionTypes.ADD_ISSUES,\r\n  payload: issues\r\n});\r\n\r\nexport const usersFailed = (errmess) => ({\r\n  type: ActionTypes.USERS_FAILED,\r\n  payload: errmess\r\n});\r\n\r\n\r\nexport const requestLogout = () => {\r\n  return {\r\n    type: ActionTypes.LOGOUT_REQUEST\r\n  }\r\n}\r\n\r\nexport const receiveLogout = () => {\r\n  return {\r\n    type: ActionTypes.LOGOUT_SUCCESS\r\n  }\r\n}\r\n\r\n\r\nexport const logoutUser = () => (dispatch) => {\r\n  dispatch(requestLogout())\r\n  localStorage.removeItem('token');\r\n  localStorage.removeItem('creds');  \r\n  localStorage.removeItem('userinfo');  \r\n  dispatch(receiveLogout())\r\n}\r\n"]},"metadata":{},"sourceType":"module"}